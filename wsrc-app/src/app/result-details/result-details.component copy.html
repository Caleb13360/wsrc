<div class="flex-grow bg-cDarkBlue pt-20 sm:pt-24 md:pt-32 lg:pt-36 text-cWhite font-roboto tracking-tighter"> 
<div class="relative h-full "> 
  
<div class="p-0 sm:p-6 mb-6 w-full">
    <!-- Header and Sub-header -->
    <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mt-8 mx-4 lg:mx-52">
        <div>
            <h1 class="text-3xl lg:text-5xl mb-2 font-roboto-condensed tracking-tighter font-bold">
                {{ race ? (race.race_name) : '???' }}
            </h1>
        </div>
    </div>
</div>

<div class="flex flex-col lg:grid lg:grid-cols-2 gap-4 px-4 lg:px-8 xl:mx-52">
    <!-- Weather -->
    <div class="flex justify-between border border-cBorderGrey bg-cDarkBlue order-1 p-5 py-5 sm:py-12">
        <!-- First Column: Temperature -->
        <div class="flex flex-col items-center justify-center leading-none p-5">
        
            <span class="text-cDarkGrey text-4xl xl:text-6xl mb-6 font-roboto tracking-tighter font-bold">{{ race ? (race.temperature) : '??' }}Â°C</span>
            <span class="text-cDarkGrey text-1xl">{{ race ? (race.cloud_cover) : '??' }}</span>
        </div>
        <!-- Second Column: Weather Descriptors -->
        <div class="flex flex-col items-start p-5 justify-center text-cDarkGrey">
            <span>Track Moisture</span>
            <span>Humidity</span>
            <span>Wind Speed</span>
            <span>Wind Direction</span>
        </div>
        <div class="flex flex-col items-start p-5 justify-center text-cDarkGrey font-bold">
        
            <span>{{ race ? (race.track_moisture) : '? ' }}</span>
            <span>{{ race ? (race.humidity) : '? ' }}%</span>
            <span>{{ race ? (race.wind_speed) : '? ' }}kph</span>
            <span>{{ race ? (race.wind_direction) : '? ' }}</span>
        </div>
        </div>

    <!-- Race Setup -->
    <div class="border border-cBorderGrey bg-cDarkBlue order-2 lg:order-3 p-4 lg:p-6">
        <div>
            <div class="flex flex-wrap sm:justify-between mb-4">
                <div class="flex items-center text-[#62D1CC] mr-4 mb-2">
                    <mat-icon>access_time</mat-icon>
                    <span class="ml-1 font-bold text-sm sm:text-base">{{ race ? (race.race_time) : '???' }} Min Race</span>
                </div>
                <div class="flex items-center text-[#FBE057] mr-4 mb-2">
                    <mat-icon>play_arrow</mat-icon>
                    <span class="ml-1 font-bold text-sm sm:text-base">{{ race ? (race.qualifier_laps) : '?' }} Quali Laps</span>
                </div>
                <div class="flex items-center text-[#FFA366] mr-4 mb-2">
                    <mat-icon>lock</mat-icon>
                    <span class="ml-1 font-bold text-sm sm:text-base">Fixed Setup</span>
                </div>
                <div class="flex items-center text-cGreen mb-2">
                    <mat-icon>attach_money</mat-icon>
                    <span class="font-bold text-sm sm:text-base">{{ race ? ('P1 - P'+race.cash_split.length.toString()) : '???' }}</span>
                </div>
            </div>
            <div class="flex flex-col space-y-2 text-cDarkGrey text-sm sm:text-base">
                <div class="flex items-center space-x-2">
                    <mat-icon>access_time</mat-icon>
                    <span>{{ race ? (race.launch_time | date: 'h:mm a') : '???' }} Race Start on {{ race ? (race.launch_time | date: 'MMMM d, y') : '???' }}</span>
                </div>
                <div class="flex items-center space-x-2">
                    <mat-icon>flag</mat-icon>
                    <span>{{ race ? (race.track_name) : '???' }} - {{ race ? (race.track_config) : '???' }}</span>
                </div>
                <div class="flex items-center space-x-2">
                    <mat-icon>directions_car</mat-icon>
                    <span>{{ race ? (race.car) : '???' }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Average Lap -->
    <div class="border border-cBorderGrey bg-cDarkBlue order-3 lg:order-2 p-4 lg:p-6 flex items-center justify-center">
        <div class="flex flex-col items-center">
            <span class="text-cGrey text-lg sm:text-xl">Average Lap Time</span>
            <span class="text-cGrey text-3xl sm:text-[2.5rem] font-bold pt-1">1:33.791</span>
        </div>
    </div>

    <!-- Fastest Lap -->
    <div class="border border-cBorderGrey bg-cDarkBlue order-4 p-4 lg:p-6 flex items-center justify-center">
        <div class="flex flex-col items-center">
            <span class="text-cGrey text-lg sm:text-xl">Fastest Lap</span>
            <span class="text-cGrey text-3xl sm:text-[2.5rem] font-bold pt-1">1:32.579</span>
        </div>
    </div>
</div>

<div class="p-0 sm:p-6 pt-3 w-full">
    <!-- Header and Sub-header -->
    <div class="flex flex-col lg:flex-row justify-between items-start xl:items-center xl:mb-6 mb-0 mt-4 mx-4 xl:mx-52">
        <div>
            <h1 class="text-3xl lg:text-5xl mb-2 font-roboto-condensed tracking-tighter font-bold">Race Results</h1>
            <h2 class="text-cWhite text-lg lg:text-2xl mb-4 font-roboto-condensed tracking-tighter">
                All the racers who have raced are shown below
            </h2>
        </div>
        <div class="text-lg lg:text-2xl hidden xl:block">
            {{results ? results.length : '?'}}/{{ race ? (race.max_racers) : '?' }} Racers
        </div>
    </div>
</div>

<!-- Table Mobile -->
<div class="overflow-x-auto mx-4 sm:mx-8 md:hidden">
    <table class="min-w-full bg-cDarkBlue">
        <thead class="border border-cBorderGrey bg-cDarkBlue">
            <tr>
                <th class="py-2 px-4 text-center">Pos.</th>
                <th class="py-2 px-4 text-center">Racer</th>
                <th class="py-2 px-4 text-center">Country</th>
                <th class="py-2 px-4 text-center">Money Won</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let result of results; let i = index" [ngClass]="{'bg-gray-800': i % 2 === 1}">
               
                <td class="py-2 px-4 text-center">{{ result.position }}</td>
                <td class="py-2 px-4 text-center">{{ result.iracing_id }}</td>
                <td class="py-2 px-4 text-center">{{ 'Country?' }}</td>
                <td class="py-2 px-4 text-center  text-cGreen">{{ 'Money Won' }}</td>
            </tr>
        </tbody>
    </table>
</div>

    <!-- Table desktop -->
    <div class="mx-10 xl:mx-60 hidden md:block mb-20">
        <table class="min-w-full bg-cDarkBlue ">
            <thead class="border border-cBorderGrey bg-cDarkBlue">
                <tr>
                    <th class="py-2 px-4 text-center">Pos.</th>
                    <th class="py-2 px-4 text-center">Racer</th>
                    <th class="py-2 px-4 text-center">Country</th>
                    <th class="py-2 px-4 text-center">Interval</th>
                    <th class="py-2 px-4 text-center ">Avg Lap Time</th>
                    <th class="py-2 px-4 text-center">Best Lap</th>
                    <th class="py-2 px-4 text-center">Inc</th>
                    <th class="py-2 px-4 text-center">Money Won</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let result of results; let i = index" [ngClass]="{'bg-gray-800': i % 2 === 1}">
                    <td class="py-2 px-4  text-center">{{ result.position }}</td>
                    <td class="py-2 px-4 text-center">{{ result.User.iracing_username }}</td>
                    <td class="py-2 px-4  text-center">{{ result.User.country ?? '-' }}</td>
                    <td class="py-2 px-4 text-center">{{ formattime(result.interval, true) }}</td>
                    <td class="py-2 px-4 text-center">{{ formattime(result.average_lap_time) }}</td>
                    <td class="py-2 px-4 text-center">{{ formattime(result.fastest_lap_time) }}</td>
                    <td class="py-2 px-4 text-center">{{ result.incidents }}</td>
                   
                    <td class="py-2 px-4  text-center text-cGreen">{{result.Races.PrizePool.cash_split[result.position-1]? '$'+(result.Races.PrizePool.cash_split[result.position-1])*result.Races.entry_fee*results.length+' USD' : '-' }}</td>
                </tr>
    
            </tbody>
        </table>
    </div>
</div>

